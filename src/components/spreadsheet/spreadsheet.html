<template>
  <require from="./spreadsheet-heading"></require>
  <require from="../../value-converters/date"></require>
  <div class="spreadsheet" scroll.trigger="handleScroll($event)">
    <table>
      <colgroup>
        <col repeat.for="column of columns" width="${column.responsive ? (100 / responsiveCols) : '0'}%"/>
      </colgroup>
      <thead>
        <tr>
          <td repeat.for="column of columns">
            <re-spreadsheet-heading
              if.bind="['select', 'favourite'].indexOf(column.type) === -1"
              column.bind="column"></re-spreadsheet-heading>
          </td>
        </tr>
      </thead>
      <tbody>
        <tr repeat.for="row of data"
          class="${row.isSelected ?  'active' : ''}"
          click.delegate="handleRowClick($event, row)">
          <td repeat.for="column of columns" css="${ column.responsive ? 'max-width: 1px;' : ''}">
            <div class="form" if.bind="column.type === 'select'">
              <label class="form-checkbox">
                <input type="checkbox" checked.bind="row.isSelected">
                <i class="form-checkbox--icon redeye-check wfm-ok"></i>
              </label>
            </div>
            <div class="form" if.bind="column.type === 'favourite'">
              <label class="form-checkbox form-checkbox__use-icon">
                <input type="checkbox" checked.bind="row.isFavourite">
                <i class="form-checkbox--icon form-checkbox--icon__unchecked redeye-star-empty wfm-star-empty"></i>
                <i class="form-checkbox--icon form-checkbox--icon__checked redeye-star wfm-star"></i>
              </label>
            </div>
            <span if.bind="column.type === 'string'">${row | getValue:column.key}</span>
            <span if.bind="column.type === 'date'">${row | getValue:column.key | date}</span>
            <span if.bind="column.type === 'custom'">
              <compose view-model.bind="column.element" containerless></compose></span>
          </td>
        </tr>        
      </tbody>
    </table>
  </div>
</template>